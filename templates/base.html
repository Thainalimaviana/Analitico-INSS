<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <title>{% block title %}Consig Tech{% endblock %}</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Tomorrow:wght@600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <script src="{{ url_for('static', filename='js/theme.js') }}"></script>

    <script>
        (function () {
            if (localStorage.getItem("theme") === "dark") {
                document.documentElement.classList.add("dark-mode");
            }
        })();
    </script>

    <style>
        .sidebar-header {
            text-align: center;
            padding: 10px 5px 0;
        }

        .sidebar-title {
            font-family: 'Tomorrow', sans-serif;
            font-size: 20px;
            font-weight: 700;
            color: var(--cor-texto);
            text-transform: uppercase;
            margin-bottom: 4px;
        }

        .sidebar-user {
            font-size: 16px;
            font-weight: 600;
            color: var(--cor-texto);
        }

        .sidebar-role {
            font-size: 13px;
            color: var(--cor-texto);
        }

        .sidebar-divider {
            height: 1px;
            width: 90%;
            background: linear-gradient(90deg, transparent, rgba(0,255,128,.6), transparent);
            margin: 8px auto;
        }

        .analitico-btn {
            display: block;
            margin: 10px;
            padding: 10px;
            text-align: center;
            background: linear-gradient(135deg, #0f9d58, #1db954);
            color: #fff;
            font-weight: 500;
            border-radius: 12px;
            text-decoration: none;
        }

        .sidebar-icons {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-bottom: 48px;
        }

        .icon-btn {
            width: 40px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.08);
            border-radius: 10px;
            border: none;
            cursor: pointer;
            color: var(--cor-texto);
            text-decoration: none;
        }

        .icon-btn:hover {
            background: rgba(255,255,255,0.18);
        }

        .material-icons {
            font-size: 22px;
        }
    </style>
</head>

<body class="pagina">

<button class="menu-toggle" id="menuToggle">
    <i class="fa-solid fa-bars"></i>
</button>

<div class="sidebar" id="sidebar">

    <div class="sidebar-header">
        <img src="{{ url_for('static', filename='img/logo.png') }}" class="sidebar-logo">

        <div class="sidebar-title">
            {{ titulo if titulo else request.endpoint.replace('_', ' ').title() }}
            <p style="font-size:14px">INSS</p>
        </div>

        <div class="sidebar-user">{{ session.get('user') }}</div>
        <div class="sidebar-role">{{ session.get('role') }}</div>

        <div class="sidebar-divider"></div>
    </div>

    <div class="menu-container">
        <ul class="menu">
            <li><a href="{{ url_for('dashboard') }}">▸ Dashboard</a></li>

            {% if session.get('role') == 'admin' %}
                <li><a href="{{ url_for('painel_admin') }}">▸ Painel Administrativo</a></li>
            {% else %}
                <li><a href="{{ url_for('painel_usuario') }}">▸ Meu Painel</a></li>
            {% endif %}

            <li><a href="{{ url_for('ranking') }}">▸ Ranking</a></li>
            <li><a href="{{ url_for('indice_dia') }}">▸ Índice do Dia</a></li>

            {% if session.get('role') != 'admin' %}
                <li><a href="{{ url_for('nova_proposta') }}">▸ Enviar Proposta</a></li>
            {% endif %}

            {% if session.get('role') == 'admin' %}
                <li><a href="{{ url_for('relatorios') }}">▸ Relatórios</a></li>
                <li><a href="{{ url_for('usuarios') }}">▸ Gerenciar Usuários</a></li>
                <li><a href="{{ url_for('register') }}">▸ Adicionar Usuário</a></li>
            {% endif %}
        </ul>
    </div>

    {% if session.get('role') == 'admin' %}
        <a href="https://analitico.onrender.com/indice_dia" class="analitico-btn">
            Analítico CLT
        </a>
    {% endif %}

    <div class="sidebar-icons">
        <button class="icon-btn" onclick="toggleTheme()" title="Tema">
            <span class="material-icons">dark_mode</span>
        </button>

        <a href="{{ url_for('logout') }}" class="icon-btn" title="Sair">
            <span class="material-icons">logout</span>
        </a>
    </div>

</div>

<div class="content">
    {% block content %}{% endblock %}
</div>

<script>
    const menuToggle = document.getElementById("menuToggle");
    const sidebar = document.getElementById("sidebar");

    menuToggle.addEventListener("click", () => {
        sidebar.classList.toggle("active");
    });
</script>

</body>
</html>
